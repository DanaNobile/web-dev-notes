# Handling CSS with Webpack
They are two separate loaders that will allow us to make use of CSS styling inside of our webpack project

1. style loader
2. css loader

![css input output diagram](https://i.imgur.com/9ROjaLf.png)

* We can work with tons of CSS files
* We can import the CSS files into each of the CSS files we care about
* If we have a new file that is `.js` and produces some HTML we can create an accompanying CSS file and we can import that into the `.js` file
    - benefit
        + Makes a clear relationship between the `.js` file and `.css` file
            * That relationship is just for us the developers
            * We are not scoping that `.css` file

Create `src/image-viewer.js`

```
const image = document.createElement('img');
image.src = 'http://lorempixel.com/200/200';

document.body.appendChild(image);
```

Now we import `image-viewer.js` into `index.js`

```
import sum from './sum';
import './image-viewer';

const total = sum(100, 500);

console.log(total);
```

* Our import is different because we didn't export anything from `image-viewer.js`
* All `image-viewer.js` has to do is run so we just import the relative path and not a default export or named export

## Create `/src/styles/image-viewer.css`
```
img {
  border: 10px solid #000;
}
```

Import it into `image-viewer.js`

```
import './styles/image-viewer.css';

const image = document.createElement('img');
image.src = 'http://lorempixel.com/400/400';

document.body.appendChild(image);
```

* When importing non `.js` files you must specify the extension

If you `$ yarn build` you'll get an error because we did not configure webpack to work with css

### We need to install two loaders
1. `css-loader` - knows how to deal with CSS imports
2. `style-loader` - takes CSS imports and adds them to the HTML document
    * It does this by injecting the CSS into a style tag inside our HTML doc

### Install css loaders
`$ yarn add css-loader style-loader -D`

`use: ['style-loader', 'css-loader']`

* This order is important, `style-loader` needs to come first
* The loaders are applied from right to left
    - `css-loader` will be loaded and then the output from that will be sent to `style-loader`

```
/* eslint-disable */
const path = require('path');

const config = {
  entry: './src/index.js',
  output: {
    path: path.resolve(__dirname, 'dist'),
    filename: 'bundle.js'
  },
  module: {
    rules: [
      {
        use: 'babel-loader',
        test: /\.js$/,
      },
      {
        use: ['style-loader', 'css-loader'],
        test: /\.css$/
      }
    ]
  }
};

module.exports = config;
```

## View in browser
* You'll see an image with a `10px` black border

### Inspect with Chrome and you'll see:

![css injected](https://i.imgur.com/fREg23t.png)

## Is Webpack all-knowing?
* We never told webpack about our HTML structure of our document
* How did it know to inject our CSS inside it?
* [Cue bizare music!](https://www.youtube.com/watch?v=-b5aW08ivHU)

1. We import css into our `image-viewer.js`
2. The CSS loader notices we imported a CSS file
3. So it takes the contents of that file
4. It sticks it inside a long string inside of our **bundle.js**

```
// module
exports.push([module.i, "img {\n  border: 10px solid #000;\n}", ""]);
```

5. The the **style-loader** looks at that string and adds code to `bundle.js` to take that string and append it to our `index.html` **<head>** tag in its own individual `<style>` tag

### This way of injecting CSS is controversial
Lots of developers are hesitant with this approach

### A better approach
Loading CSS in a separate file is a lot faster than loading up all our JavaScript and CSS in a single file because of how the browser handles parallel download requests

### Tweaking our CSS approach
We will tweak our process to spit out a separate CSS file

### extract-text-webpack-plugin
1. Will take a reference to a loader
2. Will run webpack with it
3. And it will take any text that was generated by that loader and save it into a separate file in our output directory

#### Install new plugin
`$ yarn add -D extract-text-webpack-plugin`

* `use` and `loader` should be the same thing in `webpack.config.js` but with this plugin we have to use `loader` because of the way this plugin was written
* Plugins are a different system from loaders in the webpack world
    - Loaders are used for some amount of preprocessing before a file is included into the webpack bundle
    - Plugins work a little bit outside of the webpack pipeline and they have the ability to keep files from ending up inside of the `bundle.js` output
        + And that's what we want and why we are using this
        + We want to have a separate file rather than having each CSS file getting snatched up by webpack and stuck into the file `bundle.js` output

```
  plugins: [
    new ExtractTextPlugin('style.css')
  ]
```

* The above line tells the **ExtractText** Library to find any files that were transformed by its loader (_earlier up inside of our loader_) and then saved into a file called `style.css`
    - If we have multiple CSS files inside of our project they will all be combined into this one file

```
{
  loader: ExtractTextPlugin.extract({
    loader: 'css-loader'
  }),
  test: /\.css$/
}
```

Here is our current `webpack.config.js`

```
/* eslint-disable */
const path = require('path');
const ExtractTextPlugin = require('extract-text-webpack-plugin'); // add this ine

const config = {
  entry: './src/index.js',
  output: {
    path: path.resolve(__dirname, 'dist'),
    filename: 'bundle.js'
  },
  module: {
    rules: [
      {
        use: 'babel-loader',
        test: /\.js$/,
      },
      {
        loader: ExtractTextPlugin.extract({
          loader: 'css-loader'
        }),
        test: /\.css$/
      }
    ]
  },
  plugins: [
    new ExtractTextPlugin('style.css')
  ]
};

module.exports = config;
```

## Run build
`$ npm build`

![output](https://i.imgur.com/7Xllb1T.png)

We now see `style.css` in the output

## Manually add link tag in index.html

`index.html`

```
<head>
  <link rel="stylesheet" href="dist/style.css">
</head>
<body>
  <script src="dist/bundle.js"></script>
</body>
```

And now we see our `10px` border
