# Testing with Jest and Enzyme intro
* Unit Testing against some of the functions
    - Will give the 101 of how unit testing works

## Specific to React Testing
* The 2 ways to test a component
    - Shallow rendering components
    - Mounting components
* We'll talk about the differences between the 2
    - When you would use one over the other

## Snapshot testing
* Specific to jest

## Mocking our Apollo store
* When we run our queries and mutations inside of our components how are we going to live with the data that lives in the apollo store

## Tools
* Jest (can be used for any JavaScript, not just tied to React, that is why when testing React components you will need something else to interface with and that is where Enzyme will come in)
    1. run
    2. assertion library
    3. mocking

### [Jest](https://jestjs.io/en/)
- Testing framework
    + They call it a framework because it does more than one thing
- Jest is a "test runner"
    + This means it will crawl our folder structure and look for tests that we have written
        * And then it will run those tests and show us the output
            - If they passed
            - If they failed
- There is not a lot of set up to get it running (claim to fame!)
    + But there is a little bit of setup

#### How to run Jest
`$ npm run test`

* What that will do is behind the scenes it will run Jest and watch all our files for any changes in the code and the tests that we've written
* You have an option to run them all `(just press "a")`

### Jest has an assertian library
* [expect](https://jestjs.io/docs/en/expect)
    - This is where, when we are actually running the tests, we need to tell it that "I expect this variable to equal this"
    - basic example
        + I expect the variable to equal 10
            * If it does the test passes
            * If it doesn't the test fails
        + You can expect a function to return things
        + You can expect something to be "falsey"
        + You can expect something to be "truthy"
        + You can expect something to be > or >=
        + You can expect something to match objects
        + You can expect something to be an array that contains a value
        + And a ton more scenarios

### Jest does mocking
* If you have a function that goes and off and fetches data and you want to "fake" the actual running of that function as well as the data that it returns you can replace those functions with what are called "mocks"

## Two different types of mocks
1. Jest to mock
2. We will also use tools in React Apollo that allow us to mock the store

### [Enzyme](https://airbnb.io/enzyme/)
* Will allow you to render out your React component
    - Either by shallow renderer
    - Or by mounting it
* Will allow us to interface with that component
    - You can do things like "click"
    - Click buttons
    - Trigger events
* Once those events happen you can use something similar to a jquery API to dive into your component and check that the pieces of your component are what you expect them to be
    - Example:
        + If you add a t-shirt to your cart twice
            * You will check that the pair of t-shirts are in the cart
            * You'll check that the quantity is set to 2
            * You'll check that if the shoes were $10 each then the total will be $20
            * You'll check that there is a button that is clickable
* You'll use something similar to a jQuery traversal library which makes it really easy to do it in enzyme

* Couple other libraries out there
    - [React Test Renderer](https://reactjs.org/docs/test-renderer.html)
        + Good but not as good or easy to use as enzyme

## Let's setup Jest
* tip:
    - Put your jest config and babel config inside your package.json

`frontend/package.json`

```
// MORE CODE

  "jest": {
    "setupTestFrameworkScriptFile": "<rootDir>/jest.setup.js",
    "testPathIgnorePatterns": [
      "<rootDir>/.next/",
      "<rootDir>/node_modules/"
    ],

// MORE CODE
```

### Where is our specific framework?

`<rootDir>/jest.setup.js`

`frontend/jest.setup.js`

```
import { configure } from 'enzyme';
import Adapter from 'enzyme-adapter-react-16';

configure({ adapter: new Adapter() });
```

### What do we want to ignore?
`package.json`

```
// MORE CODE

    "testPathIgnorePatterns": [
      "<rootDir>/.next/",
      "<rootDir>/node_modules/"
    ],

// MORE CODE
```

* We'll ignore
    - `node_modules`
    - And our next folder `.next` (that is generated by our nextjs)

### Watch special files
`package.json`

```
// MORE CODE

    "transform": {
      "\\.(gql|graphql)$": "jest-transform-graphql",
      ".*": "babel-jest"
    }

// MORE CODE
```

* We watch `.gql` and `.grapqhl` files
* We are not using these in this project

## Note: There is a different package for every different version of React
* Every version of React has it's own adapter

`jest.setup.js`

```
// MORE CODE

import Adapter from 'enzyme-adapter-react-16';

// MORE CODE
```

![react version adapters for enzyme](https://i.imgur.com/CemUTFA.png)

* **IMPORTANT:** As react changes you will need to update this!

## NEXt - Where do we write our tests and the basics of unit testing
